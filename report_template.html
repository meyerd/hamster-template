<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta name="author" content="hamster-applet" />
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.2/jquery-ui.min.js"></script>
	<link type="text/css" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.2/themes/base/jquery-ui.css" rel="stylesheet" />
	
	<script type="text/javascript">
	  function calc_total() {
		var sum = 0;
		var durations = document.getElementsByName("durations");
		for(var i = 0; i < durations.length; i++) {
		  var dur = parseInt(durations[i].getAttribute("dur"));
		  sum = sum + dur;
		}
		var out_elem = document.getElementById("sum_out");
		var b = document.createElement("b");
		var html_out = "Total: (" + sum + "min) ";
		if(sum > 60) {
		  html_out += Math.floor(sum / 60) + "h ";
		  sum = sum - Math.floor(sum / 60) * 60;
		}
		html_out += sum + "min ";
		var txt = document.createTextNode(html_out);
		b.appendChild(txt);
		out_elem.appendChild(b);
	  }
	</script> 

    <title>$title</title>
    <style type="text/css">
        body {
            font-family: "sans-serif";
            font-size: 12px;
            padding: 12px;
            color: #303030;
        }

        h2 {
            margin-top: 2em;
            border-bottom: 2px solid #303030;
        }
        th, td {
            text-align: left;
            padding-right: 24px;
        }

        th {
            padding-top: 12px;
        }

        .even {background-color: #eee;}
        .odd {background-color: #fff;}

        .by_day_controls {
            margin-bottom: 24px;
        }
    </style>

    <style type="text/css" media="print">
        div#tabs ul {
            display: none;
        }

        div#tabs {
            border: none;
        }

        div.by_day_controls {
            display: none;
        }

        p.template-instructions {
            display: none;
        }
    </style>

    <script type="text/javascript">
        $(document).ready(function() {
            $("#tabs").tabs()

            $("#show_details").click(function() {
                if ($(this).attr("checked")) {
                    $(".by_date_row").show();
                } else {
                    $(".by_date_row").hide();
                }

            })

            $("#show_totals").click(function() {
                if ($(this).attr("checked")) {
                    $(".by_date_total_row").show();
                } else {
                    $(".by_date_total_row").hide();
                }


            })
        });
    </script>
</head>
<body>

<h1>$title</h1>

<div id="tabs">
	<ul>
            <li><a href="#tabs-1">$totals_by_day_title</a></li>
            <li><a href="#tabs-2">$activity_log_title</a></li>
	</ul>
	<div id="tabs-1">
            <div class="by_day_controls">
                $show_prompt
                <input type="checkbox" id="show_details" checked="checked"></input>
                <label for="show_details">$activity_totals_heading</label>

                <input type="checkbox" id="show_totals" checked="checked"></input>
                <label for="show_totals">$category_totals_heading</label>
            </div>

            <table>
                <tr>
                    <th>Date</th>
                    <th class="by_date_row">$activity_totals_heading</th>
                    <th class="by_date_total_row">$category_totals_heading</th>
                </tr>

                <by_date>
                    <tr valign="top">
                        <td>$date</td>
                        <td class="by_date_row">
                            <table width="100%">
                                <by_date_activity>
                                    <tr>
                                        <td>$activity ($category)</td>
                                        <td style="text-align: right">
                                            <!-- there is also duration_decimal and duration_minutes -->
                                            $duration
                                        </td>
                                    </tr>
                                </by_date_activity>
                            </table>
                        </td>
                        <td class="by_date_total_row">
                            <table width="100%">
                                <by_date_category>
                                    <tr>
                                        <td>$category</td>
                                        <td style="text-align: right">
                                            <!-- there is also duration_decimal and duration_minutes -->
                                            $duration
                                        </td>
                                    </tr>
                                </by_date_category>
                            </table>
                        </td>
                    </tr>
                    <tr><td colspan="3">&nbsp;</td></tr>
                </by_date>
            </table>
	</div>
	<div id="tabs-2">
            <table>
                <tr>
                    <th>$header_date</th>
                    <th>$header_activity</th>
                    <th>$header_category</th>
                    <th>$header_tags</th>
                    <th>$header_start</th>
                    <th>$header_end</th>
                    <th>$header_duration</th>
                    <th>$header_description</th>
                </tr>
                <all_activities>
                    <tr>
                        <td>
                            <!-- there is also date_iso -->
                            $date
                        </td>
                        <td>$activity</td>
                        <td>$category</td>
                        <td>$tags</td>
                        <td>
                            <!-- there is also start_iso -->
                            $start
                        </td>
                        <td>
                            <!-- there is also end_iso -->
                            $end
                        </td>
                        <td>
                            <!-- there is also duration_decimal and duration_minutes -->
							$duration<div name="durations" style="display: none" dur="$duration_minutes"></div>
                        </td>
                        <td>$description</td>
                    </tr>
					</all_activities>
					<tr><td colspan="8"></br></td></tr>
					<tr>
					  <td colspan="8">
						<div id="sum_out"></div>
					  </td>
					</tr>
				</table>
	</div>
  </div>

  <script type="text/javascript">
	  calc_total();
  </script>

<p class="template-instructions">
    <a href="file:///$data_dir/report_template.html">$show_template</a>.
    $template_instructions.
</p>
</body>
</html>
